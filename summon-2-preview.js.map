{"version":3,"sources":["node_modules/browser-pack/_prelude.js","summon-2-preview.js","summon_2_src/js/summon-2-preview.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","dateConvert","date","parsed","match","angular","run","templateCache","docSummary","template","get","jQuery","_","mixin","joinArray","arr","join","directive","link","scope","element","resultsUrl","window","location","href","formBaseUrl","moreSourcesBaseUrl","thisDoc","document","articleTitle","full_title","replace","articleAuthors","chain","authors","pluck","value","publication","summary","journalTitle","publication_title","issn","undefined","issns","publication_date","volume","volumes","issue","issues","startPage","start_pages","pages","contentType","content_type","fullTextUrl","has_fulltext","fulltext_link","queryString","encodeURIComponent","formHref","moreSourcesHref","formLink","moreSourcesLink","$togglePreviewParent","find","last","append","brokenLinkHeight","Math","floor","moreSourcesHeight","fancybox","selector","type","title","iframe","css","height","arrows","infobar","smallBtn","attr","ajax","url","dataType","cache","done","help"],"mappings":"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","file":"summon-2-preview.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\n// Code for Angular 1.6.4\nangular.module('summonApp').run(['$templateCache', function (templateCache) {\n    var docSummary = \"/assets/documentSummary.html\";\n    var template = templateCache.get(docSummary);\n    var $template = jQuery(template);\n    // console.log(template);\n    // templateCache.put(docSummary, newTemplate);\n}]);\n\n// Underscore mixin for joining arrays\n_.mixin({\n    joinArray: function joinArray(arr) {\n        return arr.join(', ');\n    }\n});\n\n// Convert date to YYYY-MM-DD\nfunction dateConvert(date) {\n    var parsed = date.match(/(\\d\\d)?\\/?(\\d\\d)?\\/?(\\d\\d\\d\\d)$/);\n    if (parsed) {\n        date = parsed[3] + (parsed[1] ? '-' + parsed[1] + (parsed[2] ? '-' + parsed[2] : '') : '');\n    }\n    return date;\n}\n\n// View document-summary directive scope\nangular.module('summonApp.directives').directive(\"documentSummary\", function () {\n    return {\n        link: function link(scope, element) {\n            // console.log(\"scope object in documentSummary directive:\");\n            // console.dir(scope);\n            // console.log(\"element object in documentSummary directive:\");\n            // console.log(element);\n            // console.log(\"html generated before directive has finished executing\");\n            // console.log(element.html());\n\n            // Define constants\n            var resultsUrl = window.location.href;\n            var formBaseUrl = \"https://unt.az1.qualtrics.com/jfe/form/SV_bdw4fydzCuTGPDD\";\n            var moreSourcesBaseUrl = \"https://ui.library.unt.edu/summon-hack/more_sources.php\";\n\n            var thisDoc = scope.document;\n            var articleTitle = thisDoc.full_title.replace(/<[^>]*>/g, ''); // remove html tags in string\n            var articleAuthors = _.chain(thisDoc.authors).pluck('fullname').joinArray().value();\n            var publication = scope.summary;\n            var journalTitle = thisDoc.publication_title;\n            var issn = thisDoc.issns == undefined ? '' : thisDoc.issns.join(', ');\n            var date = dateConvert(thisDoc.publication_date);\n            var volume = thisDoc.volumes == undefined ? '' : thisDoc.volumes.join(', ');\n            var issue = thisDoc.issues == undefined ? '' : thisDoc.issues.join(', ');\n            var startPage = thisDoc.start_pages == undefined ? '' : thisDoc.start_pages.join(', ');\n            var pages = thisDoc.pages;\n            var contentType = thisDoc.content_type;\n            var fullTextUrl = thisDoc.has_fulltext ? thisDoc.fulltext_link : '';\n            var queryString = \"?article_title=\" + encodeURIComponent(articleTitle) + \"&article_authors=\" + encodeURIComponent(articleAuthors) + \"&publication=\" + encodeURIComponent(publication) + \"&journal_title=\" + encodeURIComponent(journalTitle) + \"&issn=\" + encodeURIComponent(issn) + \"&date=\" + encodeURIComponent(date) + \"&volume=\" + encodeURIComponent(volume) + \"&issue=\" + encodeURIComponent(issue) + \"&pages=\" + (startPage ? encodeURIComponent(startPage) : encodeURIComponent(pages)) + \"&content_type=\" + encodeURIComponent(contentType) + \"&url=\" + encodeURIComponent(fullTextUrl) + \"&results_url=\" + encodeURIComponent(resultsUrl);\n            var formHref = formBaseUrl + queryString;\n            var moreSourcesHref = moreSourcesBaseUrl + queryString;\n\n            var formLink = jQuery('<a class=\"fancybox\" href=\"' + formHref + '\" title=\"Report Broken Full-Text Link\">Report Broken Link</a>');\n            var moreSourcesLink = jQuery('<a class=\"fancybox\" href=\"' + moreSourcesHref + '\" title=\"Check More Sources to Get the Full Text of this Article\">Check More Sources</a>');\n\n            if (thisDoc.has_fulltext) {\n                // div.togglePreview isn't in the DOM yet, so we have to traverse to find these links\n                var $togglePreviewParent = element.find('.docFooter').find('.row').last().find('div');\n                $togglePreviewParent.append(jQuery('<div class=\"unt-more-sources\"></div>').append(moreSourcesLink));\n                $togglePreviewParent.append(jQuery('<div class=\"unt-rbl\"></div>').append(formLink));\n\n                var brokenLinkHeight = 680 + (Math.floor(articleTitle.length / 80) + Math.floor(articleAuthors.length / 80) + Math.floor(publication.length / 80)) * 40;\n                var moreSourcesHeight = brokenLinkHeight - 230;\n\n                jQuery().fancybox({\n                    selector: '.unt-rbl .fancybox',\n                    type: 'iframe',\n                    title: '',\n                    iframe: {\n                        css: {\n                            height: brokenLinkHeight\n                        }\n                    },\n                    arrows: false,\n                    infobar: false,\n                    smallBtn: true\n                });\n\n                jQuery().fancybox({\n                    selector: '.unt-more-sources .fancybox',\n                    type: 'iframe',\n                    title: '',\n                    iframe: {\n                        css: {\n                            height: moreSourcesHeight\n                        }\n                    },\n                    arrows: false,\n                    infobar: false,\n                    smallBtn: true\n                });\n            }\n        }\n    };\n});\n\n// Load fancybox with jQuery\njQuery(function () {\n    jQuery('head').append(jQuery('<link rel=\"stylesheet\" type=\"text/css\" />').attr('href', 'https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.css'));\n    jQuery(\"head\").append('<link href=\"https://ui.library.unt.edu/summon-hack/summon-2-styles-local.css?v=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" />');\n    jQuery.ajax({\n        url: 'https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.js',\n        dataType: 'script',\n        cache: true\n    }).done(function () {\n        // Init fancybox links\n        var help = jQuery(\"a:contains('Help')\");\n        if (help.length) {\n            help.fancybox({ type: \"iframe\" });\n        }\n    });\n});\n\n},{}]},{},[1])\n\n","// Code for Angular 1.6.4\nangular.module('summonApp').run(['$templateCache', function (templateCache) {\n    const docSummary = \"/assets/documentSummary.html\";\n    const template = templateCache.get(docSummary);\n    const $template = jQuery(template);\n    // console.log(template);\n    // templateCache.put(docSummary, newTemplate);\n}]);\n\n// Underscore mixin for joining arrays\n_.mixin({\n    joinArray: function (arr) {\n        return arr.join(', ');\n    }\n});\n\n// Convert date to YYYY-MM-DD\nfunction dateConvert(date) {\n    var parsed = date.match(/(\\d\\d)?\\/?(\\d\\d)?\\/?(\\d\\d\\d\\d)$/);\n    if (parsed) {\n        date = parsed[3] + (parsed[1] ? '-' + parsed[1] + (parsed[2] ? '-' + parsed[2] : '') : '');\n    }\n    return date;\n}\n\n// View document-summary directive scope\nangular.module('summonApp.directives').directive(\"documentSummary\", function () {\n    return {\n        link: function (scope, element) {\n            // console.log(\"scope object in documentSummary directive:\");\n            // console.dir(scope);\n            // console.log(\"element object in documentSummary directive:\");\n            // console.log(element);\n            // console.log(\"html generated before directive has finished executing\");\n            // console.log(element.html());\n\n            // Define constants\n            const resultsUrl = window.location.href;\n            const formBaseUrl = \"https://unt.az1.qualtrics.com/jfe/form/SV_bdw4fydzCuTGPDD\";\n            const moreSourcesBaseUrl = \"https://ui.library.unt.edu/summon-hack/more_sources.php\";\n\n            const thisDoc = scope.document;\n            const articleTitle = thisDoc.full_title.replace(/<[^>]*>/g, ''); // remove html tags in string\n            const articleAuthors = _.chain(thisDoc.authors)\n                .pluck('fullname')\n                .joinArray()\n                .value();\n            const publication = scope.summary;\n            const journalTitle = thisDoc.publication_title;\n            const issn = thisDoc.issns == undefined ? '' : thisDoc.issns.join(', ');\n            const date = dateConvert(thisDoc.publication_date);\n            const volume = thisDoc.volumes == undefined ? '' : thisDoc.volumes.join(', ');\n            const issue = thisDoc.issues == undefined ? '' : thisDoc.issues.join(', ');\n            const startPage = thisDoc.start_pages == undefined ? '' : thisDoc.start_pages.join(', ');\n            const pages = thisDoc.pages;\n            const contentType = thisDoc.content_type;\n            const fullTextUrl = thisDoc.has_fulltext ? thisDoc.fulltext_link : '';\n            const queryString = \"?article_title=\" + encodeURIComponent(articleTitle) +\n                \"&article_authors=\" + encodeURIComponent(articleAuthors) +\n                \"&publication=\" + encodeURIComponent(publication) +\n                \"&journal_title=\" + encodeURIComponent(journalTitle) +\n                \"&issn=\" + encodeURIComponent(issn) +\n                \"&date=\" + encodeURIComponent(date) +\n                \"&volume=\" + encodeURIComponent(volume) +\n                \"&issue=\" + encodeURIComponent(issue) +\n                \"&pages=\" + (startPage ? encodeURIComponent(startPage) : encodeURIComponent(pages)) +\n                \"&content_type=\" + encodeURIComponent(contentType) +\n                \"&url=\" + encodeURIComponent(fullTextUrl) +\n                \"&results_url=\" + encodeURIComponent(resultsUrl);\n            const formHref = formBaseUrl + queryString;\n            const moreSourcesHref = moreSourcesBaseUrl + queryString;\n\n            const formLink = jQuery(`<a class=\"fancybox\" href=\"${formHref}\" title=\"Report Broken Full-Text Link\">Report Broken Link</a>`);\n            const moreSourcesLink = jQuery(`<a class=\"fancybox\" href=\"${moreSourcesHref}\" title=\"Check More Sources to Get the Full Text of this Article\">Check More Sources</a>`);\n\n            if (thisDoc.has_fulltext) {\n                // div.togglePreview isn't in the DOM yet, so we have to traverse to find these links\n                const $togglePreviewParent = element.find('.docFooter').find('.row').last().find('div');\n                $togglePreviewParent.append(jQuery(`<div class=\"unt-more-sources\"></div>`).append(moreSourcesLink));\n                $togglePreviewParent.append(jQuery(`<div class=\"unt-rbl\"></div>`).append(formLink));\n\n                const brokenLinkHeight = 680 + (Math.floor(articleTitle.length / 80) + Math.floor(articleAuthors.length / 80) + Math.floor(publication.length / 80)) * 40;\n                const moreSourcesHeight = brokenLinkHeight - 230;\n\n                jQuery().fancybox({\n                    selector: '.unt-rbl .fancybox',\n                    type: 'iframe',\n                    title: '',\n                    iframe: {\n                        css: {\n                            height: brokenLinkHeight,\n                        }\n                    },\n                    arrows: false,\n                    infobar: false,\n                    smallBtn: true,\n                });\n\n                jQuery().fancybox({\n                    selector: '.unt-more-sources .fancybox',\n                    type: 'iframe',\n                    title: '',\n                    iframe: {\n                        css: {\n                            height: moreSourcesHeight,\n                        }\n                    },\n                    arrows: false,\n                    infobar: false,\n                    smallBtn: true,\n                })\n            }\n        }\n    }\n});\n\n// Load fancybox with jQuery\njQuery(function () {\n    jQuery('head').append(jQuery('<link rel=\"stylesheet\" type=\"text/css\" />').attr('href', 'https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.css'));\n    jQuery(\"head\").append('<link href=\"https://ui.library.unt.edu/summon-hack/summon-2-styles-local.css?v=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" />');\n    jQuery.ajax({\n        url: 'https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.js',\n        dataType: 'script',\n        cache: true\n    }).done(function () {\n        // Init fancybox links\n        const help = jQuery(\"a:contains('Help')\");\n        if (help.length) {\n            help.fancybox({type: \"iframe\"});\n        }\n    })\n});"]}